"use strict";var CITY_AJAX=null;$(document).ready(function(){window.$Setting={ini:function(){$Setting.Menu();$Setting.iconNumChange();$Setting.addTionalSearch();$Setting.onSearchAdd();$Setting.fontColor();$Setting.setCity();$Setting.$bg.ini();$setData.ini();$dataRestore.ini();$setting.onChange();$setting.onRangeChange();var a=$setting.get("autoWallpaper");if(a){$("#autoWallpaperHover").hide()}else{$("#autoWallpaperHover").show()}if($setting.get("wcity")==""){$("#CurrentLocation").text(i18n("Locating"))}else{$("#CurrentLocation").text($setting.get("wcity"))}try{if(isZh()){$("#aboutTranslate").hide()}}catch(b){}},setCity:function(){$("#weatherinput").live("input",function(a){try{var c=$(this).val();if(c==""){$("#addThatCity").fadeOut(100)}if(CITY_AJAX){CITY_AJAX.abort()}CITY_AJAX=$.ajax({url:"http://query.yahooapis.com/v1/public/yql",type:"get",dataType:"json",data:{"q":'select * from weather.forecast where woeid in (select woeid from geo.places(1) where text="'+c+'")',"format":"json"},}).done(function(e){var d=e.query.results.channel;var g=d.location.city;var f=d.location.country;$("#addThatCity").fadeIn(100);$("#addThatCity").val("+"+g);$("#addThatCity").attr({"city":g,"country":f})}).fail(function(){$("#addThatCity").fadeOut(100)})}catch(b){}});$("#addThatCity").live("click",function(a){if($(this).attr("city")!=""){var c=$(this).attr("city");var b=$(this).attr("country");$setting.set("wcity",c);$setting.set("wcountry",b);$("#CurrentLocation").text(c);getCityByCity();$("#addThatCity").fadeOut(200);$("#weatherinput").val("");$notification.show((i18n("WeatherLocationHasBeenSettedTo")+" "+c),true)}});$("#weatherinput").live("keydown",function(a){if(a.which==13){if($("#addThatCity").attr("city")!=""){var c=$("#addThatCity").attr("city");var b=$("#addThatCity").attr("country");$setting.set("wcity",c);$setting.set("wcountry",b);$("#CurrentLocation").text(c);getCityByCity();$("#addThatCity").fadeOut(200);$("#weatherinput").val("");$notification.show((i18n("WeatherLocationHasBeenSettedTo")+" "+c),true)}}});$("[name=temperatureUnit]").live("click",function(a){if($setting.get("wcity")==""){autoWeather()}else{getCityByCity()}})},Menu:function(){$("[type=setting]").live("click",function(a){if($my.slide.setting){$("#settingSlide .topMenu").css("border-bottom","");$("[in=settingSlide]:nth-child(2)").css("border-bottom","solid 2px #fdfdfd");$("#setting0SlideBox,#setting0SlideMenu").hide();$("#setting1SlideBox,#setting1SlideMenu").show();return false}});$(".ST").live("click",function(a){var b=$(this)[0].id;$(".ST").css("color","");$(this).css("color","#2ECC71");$(".settingBox").hide();$("#settingBox"+b).show()})},iconNumChange:function(){$("[name=iconNum]").live("change",function(h){var i=$(this).val();var e=i.split("x");var f=parseInt(e[0]);var d=parseInt(e[1]);var c=JSON.parse(localStorage.main);var g=arrayGroupByNum(c,f*d);localStorage.main=JSON.stringify(g);$iconIni.load(g,i);$(".icon").css("-webkit-animation","zoom 0.2s ease");$onSlide.slideTo("#mainAll",0)})},addTionalSearch:function(){var b=$setting.get("searchBottom");var d="";for(var a=0;a<b.length;a++){if(a==0){var c="-webkit-filter:grayscale(1);"}else{var c=""}d+='<div class="additional">';d+='<div class="additionName">'+b[a].name+"</div>";d+='<div class="additionDelete"></div>';d+='<div class="additionTop" style="'+c+'">â†‘</div>';d+="</div>"}$("#AddSe").html(d)},onSearchAdd:function(){$("#addSearchBu").live("click",function(b){var c=$("#addSearchName").val();var d=$("#addSearchUrl").val();if(c==""||d==""){var i=i18n("CanNotBeEmpty");$notification.show(i);return false}var f=d.length;var h=d.indexOf("%s");var e=d.substring(0,h);var g=d.substring(h+2,f);var k={"name":c,"searchStart":e,"searchEnd":g};var j=$setting.get("searchBottom");j.push(k);$setting.set("searchBottom",j);$Setting.addTionalSearch();$("#addSearchName").val("");$("#addSearchUrl").val("")});$(".additionDelete").live("click",function(b){var c=$(this).parent().index();var a=$setting.get("searchBottom");a.splice(c,1);$setting.set("searchBottom",a);$Setting.addTionalSearch()});$(".additionTop").live("click",function(d){var e=$(this).parent().index();var c=$setting.get("searchBottom");var b=c[e];c.splice(e,1);c.unshift(b);$setting.set("searchBottom",c);$Setting.addTionalSearch()})},fontColor:function(){var a=$setting.get("fontColor");for(var b=0;b<$(".fontColorSelect").length;b++){var d=$($(".fontColorSelect")[b]).attr("color");if(a==d){$(".fontColorSelect").css("border-color","");var c=$($(".fontColorSelect")[b]).css("background-color");$($(".fontColorSelect")[b]).css("border-color",c);$(".globalColor").css("color",a)}}$(".fontColorSelect").live("click",function(f){var e=$(this).attr("color");$(".fontColorSelect").css("border-color","");var g=$(this).css("background-color");$(this).css("border-color",g);$(".globalColor").css("color",e);$setting.set("fontColor",e)})},$bg:{ini:function(){var a=new Filer();a.init({persistent:false,size:1024*1024*1024},function(b){},onError);$Setting.$bg.blurChange();$Setting.$bg.localWallpaper(a);
$Setting.$bg.restoreWallpaper();$Setting.$bg.autoWallpaperChange();$Setting.$bg.downloadWallpaper()},localWallpaper:function(a){try{$("#getLocalWallpaper").live("click",function(c){$(this).val("")});$("#getLocalWallpaper")[0].onchange=function(){try{$("#waiting").show();slideLock();var d=this.files[0];var c=new FileReader();c.readAsDataURL(d);c.onload=function(){var g=c.result;var e=getblobUrl(g);console.log(e);saveAllImage(a,e,function(){var h=$setting.get("blurWallpaper");if(h){$("#bgOut").css("background-image","url(filesystem:chrome-extension://"+APPID+"/temporary/localBlur.jpg?time="+new Date().getTime()+")");$setting.set("lastWallpaper","filesystem:chrome-extension://"+APPID+"/temporary/localBlur.jpg?time="+new Date().getTime())}else{$("#bgOut").css("background-image","url(filesystem:chrome-extension://"+APPID+"/temporary/local.jpg?time="+new Date().getTime()+")");$setting.set("lastWallpaper","filesystem:chrome-extension://"+APPID+"/temporary/local.jpg?time="+new Date().getTime())}localStorage.newLocal="1";$setting.set("bgType","user");$("#waiting").hide();slideUnLock();$setting.set("autoWallpaper",false);$("#autoWallpaperButton").removeAttr("checked");$("#autoWallpaperHover").show()})}}catch(f){console.log(f)}$("#uploadImage2").val("")}}catch(b){}},blurChange:function(){$("#blurButton").live("change",function(a){try{wallpaperToblur()}catch(b){console.log(b)}})},restoreWallpaper:function(){$("#RestoreWallpaperButton").live("click",function(a){$setting.set("autoWallpaper",false);$("#autoWallpaperButton").removeAttr("checked");var b=$setting.get("blurWallpaper");if(b){$setting.set("lastWallpaper","img/bgblur.jpg")}else{$setting.set("lastWallpaper","img/bg.jpg")}$("#bgOut").css("background-image","url("+$setting.get("lastWallpaper")+")");$setting.set("bgType","default");$setting.set("bgname","bg");$setting.sync()})},autoWallpaperChange:function(){$("#autoWallpaperButton").live("click",function(b){var a=$(this).is(":checked");if(a){$("#autoWallpaperHover").fadeOut(100)}else{$("#autoWallpaperHover").fadeIn(100)}setAutoBg()});$(".autobgs").live("click",function(a){setAutoBg()})},downloadWallpaper:function(){$("#DownloadWallpaperButton").live("click",function(c){var b=document.createElement("a");b.href=$setting.get("lastWallpaper");b.download="infinityWallpaper.jpg";b.click();$(b).remove()})}}};$Setting.ini()});