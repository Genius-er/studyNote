$(document).ready(function(){$("#Editflat1").spectrum({preferredFormat:"rgb",flat:!0,showInput:!0});var k=Math.round($setting.get("iconFillet"))/2+"%";$("#EditiconPreviewTop").css("border-radius",k);try{$("#EdituploadImage")[0].onchange=function(){try{$("#EditiconPreview").text("");var a=this.files[0],b=new FileReader,c=document.getElementById("Editmycanvas"),d=c.getContext("2d");b.onload=function(a){var b=new Image;b.onload=function(){$(c).attr("cimg",b.src);c.width=300;c.height=300;var a=Math.round(300*
b.height/b.width),e=Math.round(0),f=Math.round((300-a)/2);d.drawImage(b,e,f,300,a);$("#EditiconPreview").attr("bgImg",c.toDataURL());$("#EditiconPreview").attr({left:e,top:f})};b.src=a.target.result};b.readAsDataURL(a);$("#Editremove,#EditimgSize,#EditimageSize,.EditadjustBu").fadeIn(100);$("#EditiconPreview").attr("dragMove","true");$("#EditiconPreviewTop").css({"background-color":"transparent","background-image":"url(../img/transparent.png)"});$(".EditicobgColor").css("border-color","transparent");
$("#EdittransparentBg").css("border-color","#ccc")}catch(e){}},$("#EditimgSize").live("input",function(a){$("#EditiconPreview").text("");a=$(this).val();var b=document.getElementById("Editmycanvas"),c=b.getContext("2d");c.clearRect(0,0,b.width,b.height);var d=$(b).attr("cimg"),e=new Image;e.src=d;var d=Math.round(a*e.height/e.width),f=Math.round((300-a)/2),g=Math.round((300-d)/2);c.drawImage(e,f,g,a,d);$("#EditiconPreview").attr({left:f,top:g});$("#EditiconPreview").attr("bgImg",b.toDataURL())}),
$("#EditiconPreviewTop").live("mousedown",function(a){var b=a.pageX;a=a.pageY;var c=$("#EditiconPreview").attr("left"),d=$("#EditiconPreview").attr("top");$("#EditiconPreview").attr({useleft:c,usetop:d});$(this).attr({x:b,y:a})}),$("#EditiconPreviewTop").live("mousemove",function(a){if(1==a.which&&"true"==$("#EditiconPreview").attr("dragMove")){$("#EditiconPreview").text("");var b=$("#EditimgSize").val(),c=parseInt($(this).attr("x")),d=parseInt($(this).attr("y")),e=a.pageX;a=a.pageY;var f=Math.round($("#EditiconPreview").attr("useleft")),
g=Math.round($("#EditiconPreview").attr("usetop")),c=f+3*(e-c),d=g+3*(a-d),e=document.getElementById("Editmycanvas");a=e.getContext("2d");a.clearRect(0,0,e.width,e.height);f=$(e).attr("cimg");g=new Image;g.src=f;var f=Math.round(b*g.height/g.width),h=Math.round((300-b)/2);Math.round((300-f)/2);a.drawImage(g,h+c,h+d,b,f);$("#EditiconPreview").attr("left",c);$("#EditiconPreview").attr("top",d);$("#EditiconPreview").attr("bgImg",e.toDataURL())}}),$("#Editremove").click(function(a){$("#EditiconPreview").css("background-image",
"");$("#EditiconPreview").attr("bgImg","");$("#EditiconPreview").attr({top:"0",left:"0"});$("#EdituploadImage").val("");a=document.getElementById("Editmycanvas");a.getContext("2d").clearRect(0,0,a.width,a.height);$("#Editremove,#EditimgSize,#EditimageSize,.EditadjustBu,#EditshareIcon").fadeOut(100);$("#EditiconPreview").text($("#EditaddTitle").val().substring(0,4));$("#EditiconPreview").attr("dragMove","false");$(".EditicobgColor").css("border-color","transparent");a=$(".EditicobgColorPre:nth-child(1)").css("background-color");
$(".EditicobgColorPre:nth-child(1)").css("border-color",a);$("#EditiconPreviewTop").css({"background-color":a,"background-image":""})}),$(".editico").live("click",function(a){if(!isAllSlideFalse()){slideLock();$("#EditiconPreview").text("");$("#editBoxHover").show();$("#EditiconPreview").attr("dragMove","false");$(".EditicobgColor").css("border-color","transparent");var b=RGBToHex($(this).parent().attr("bgColor"));for(a=1;10>a;a++)RGBToHex($(".EditicobgColorPre:nth-child("+a+")").css("background-color"))==
b&&$(".EditicobgColorPre:nth-child("+a+")").css("border-color",b);$("#EditiconPreviewTop").css({"background-color":b,"background-image":""});$("#Editremove,#EditimgSize,#EditimageSize,.EditadjustBu,#EditshareIcon").hide();$("#EditiconPreview").css("background-image","");$("#EditiconPreview").attr("bgImg","");$("#EditiconPreview").attr({top:"0",left:"0"});$("#EdituploadImage").val("");a=$(this).parent().index();var b=$(this).parent().parent().parent().index(),c=$(this).parent().attr("type");$("#EditiconPreview").attr({n:b,
i:a,icotype:c});var d=document.getElementById("Editmycanvas"),e=d.getContext("2d");e.clearRect(0,0,d.width,d.height);a=$(this).parent().attr("url");b=$(this).parent().attr("iconname");c=$(this).parent().attr("ico");$("#EditaddTitle").val(b);$("#EditaddUrl").val(a);$("#EditpreviewName").text(b);if(""!=c){var d=document.getElementById("Editmycanvas"),e=d.getContext("2d"),f=new Image;f.src=c;f.onload=function(){$(d).attr("cimg",f.src);d.width=300;d.height=300;var a=Math.round(300*f.height/f.width),b=
Math.round(0),c=Math.round((300-a)/2);e.drawImage(f,b,c,300,a);$("#EditiconPreview").attr("bgImg",d.toDataURL());$("#EditiconPreview").attr({left:b,top:c})};$("#Editremove,#EditimgSize,#EditimageSize,.EditadjustBu").show();$("#EditiconPreview").attr("dragMove","true");if("#"==ebgColor)$("#EditiconPreviewTop").css({"background-color":"transparent","background-image":"url(../img/transparent.png)"});else{for(a=1;10>a;a++)RGBToHex($(".EditicobgColorPre:nth-child("+a+")").css("background-color"))==ebgColor&&
$(".EditicobgColorPre:nth-child("+a+")").css("border-color",ebgColor);$("#EditiconPreviewTop").css({"background-color":ebgColor,"background-image":""})}$(".EditicobgColor").css("border-color","transparent");$("#EdittransparentBg").css("border-color","#ccc")}else $("#EditiconPreview").text(b)}}),$(".EditicobgColorPre").live("click",function(a){$(".EditicobgColor").css("border-color","transparent");a=$(this).css("background-color");$(this).css("border-color",a);$("#EditiconPreviewTop").css({"background-color":a,
"background-image":""})}),$(".sp-input").attr("disabled","disabled"),$("#EditColorPicker").click(function(){if("true"==$(this).attr("show")){$("#Editpicker").fadeOut(100);var a=$("#Editpicker .sp-input").val();$("#EditiconPreviewTop").css({"background-color":a});$(".EditicobgColor").css("border-color","");$("#EditColorPicker").css("border-color",a);$(this).attr("show","false")}else $("#Editpicker").fadeIn(100),$(this).attr("show","true")}),$("#Editpicker").live("mousemove",function(a){1==a.which&&
(a=$("#Editpicker .sp-input").val(),$(".EditicobgColor").css("border-color",""),$("#EditiconPreviewTop").css({"background-color":a,"background-image":""}),$("#EditColorPicker").css("border-color",a))}),$(document).mousedown(function(a){"Editpicker"!=a.target.id&&"EditBu"!=a.target.id&&"EditColorPicker"!=a.target.id&&($("#Editpicker").fadeOut(100),$("#EditColorPicker").attr("show","false"))}),$("#EdittransparentBg").live("click",function(a){$(".EditicobgColor").css("border-color","");$(this).css("border-color",
"#ccc");$("#EditiconPreviewTop").css({"background-color":"transparent","background-image":"url(../img/transparent.png)"})}),$("#EditaddTitle").live("input",function(a){a=$(this).val();var b="";$("#EditpreviewName").text(a);b=a.substring(0,4);""==$("#EditiconPreview").attr("bgImg")&&(""==a&&$("#EditpreviewName").text(i18n("addTitle")),$("#EditiconPreview").text(b))}),$("#EditBu").live("click",function(a){try{var b=$("#EditaddTitle").val(),c=$("#EditaddUrl").val();0<c.indexOf("://")||0<=c.indexOf("mailto:")||
(c="http://"+c);var d=$("#EditiconPreviewTop").css("background-color"),e=$("#EditiconPreview").attr("bgImg"),f=$("#EditiconPreview").text(),g=parseInt($("#EditiconPreview").attr("n")),h=parseInt($("#EditiconPreview").attr("i")),l=$("#EditiconPreview").attr("icotype");"app"==l&&(l="ico");a={type:l,name:b,url:c,bgColor:d,title:f,ico:e};var m=JSON.parse(localStorage.main);m[g][h]=a;localStorage.main=JSON.stringify(m);$iconIni.load(m);$(".groupIn:nth-child("+(g+1)+")").children(".icon:nth-child("+(h+
1)+")").css({"-webkit-animation":"zoomOut 0.2s ease","-webkit-transform":"scale(1)"});var k=_getCurrentN()+1;$(".point").css("background-color","");$(".point:nth-child("+k+")").css("background-color",i18n("pointColor"));$notification.show(b+i18n("HasBeenUpdated"),!0);$setting.sync()}catch(n){}})}catch(n){}});